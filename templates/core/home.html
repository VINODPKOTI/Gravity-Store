{% extends 'base.html' %}
{% load static %}

{% block title %}Welcome to Aaramba{% endblock %}

{% block content %}

{% if banners %}
<!-- HERO / BANNER -->
<section class="relative bg-white border-b border-zinc-100 overflow-hidden">

    <!-- Responsive Height -->
    <div class="relative w-full h-[260px] sm:h-[320px] md:h-[420px] lg:h-[520px]">

        {% for banner in banners %}
        <div
            class="absolute inset-0 transition-opacity duration-1000
                   {% if forloop.first %}opacity-100 z-10{% else %}opacity-0 z-0{% endif %}
                   banner-slide"
            style="
                background-image: url('{{ banner.image.url }}');
                background-size: cover;
                background-position: center top;
            ">

            <!-- Dark overlay -->
            <div class="absolute inset-0 bg-black/30"></div>

            <!-- Bottom gradient for text -->
            <div class="absolute inset-x-0 bottom-0 h-40 bg-gradient-to-t from-black/70 to-transparent"></div>

            <!-- Content -->
            <div class="container mx-auto px-4 h-full flex items-center justify-center text-center relative z-20">
                <div class="space-y-4 max-w-3xl">

                    <h1 class="text-2xl sm:text-3xl md:text-5xl lg:text-6xl
                               font-extrabold tracking-tight text-white drop-shadow-lg">
                        {{ banner.title }}
                    </h1>

                    {% if banner.subtitle %}
                    <p class="text-white text-sm sm:text-lg md:text-2xl drop-shadow-md">
                        {{ banner.subtitle }}
                    </p>
                    {% endif %}

                    {% if banner.link %}
                    <a href="{{ banner.link }}"
                       class="inline-flex h-10 sm:h-12 px-6 sm:px-8
                              rounded-md bg-white text-sm font-semibold
                              text-zinc-900 hover:bg-zinc-100 transition">
                        Explore Now
                    </a>
                    {% elif banner.product %}
                    <a href="{% url 'products:product_detail' banner.product.pk %}"
                       class="inline-flex h-10 sm:h-12 px-6 sm:px-8
                              rounded-md bg-white text-sm font-semibold
                              text-zinc-900 hover:bg-zinc-100 transition">
                        Shop Now
                    </a>
                    {% elif banner.category %}
                    <a href="{% url 'products:product_list_by_category' banner.category.slug %}"
                       class="inline-flex h-10 sm:h-12 px-6 sm:px-8
                              rounded-md bg-white text-sm font-semibold
                              text-zinc-900 hover:bg-zinc-100 transition">
                        Browse Category
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    {% if banners|length > 1 %}
    <!-- Dots -->
    <div class="absolute bottom-4 left-0 right-0 flex justify-center gap-3 z-30">
        {% for banner in banners %}
        <button
            onclick="showBanner({{ forloop.counter0 }})"
            class="w-2.5 h-2.5 rounded-full bg-white/40
                   transition-all duration-300
                   banner-dot {% if forloop.first %}bg-white scale-125{% endif %}">
        </button>
        {% endfor %}
    </div>
    {% endif %}
</section>

<!-- Banner Script -->
<script>
    let currentBanner = 0;
    const banners = document.querySelectorAll('.banner-slide');
    const dots = document.querySelectorAll('.banner-dot');
    const total = banners.length;

    function showBanner(index) {
        banners.forEach(b => {
            b.classList.remove('opacity-100', 'z-10');
            b.classList.add('opacity-0', 'z-0');
        });
        dots.forEach(d => d.classList.remove('bg-white', 'scale-125'));

        banners[index].classList.add('opacity-100', 'z-10');
        banners[index].classList.remove('opacity-0', 'z-0');
        dots[index].classList.add('bg-white', 'scale-125');

        currentBanner = index;
    }

    if (total > 1) {
        setInterval(() => {
            showBanner((currentBanner + 1) % total);
        }, 5000);
    }
</script>

{% else %}
<!-- FALLBACK HERO -->
<section class="py-20 md:py-32 bg-white border-b border-zinc-100">
    <div class="container mx-auto px-4 text-center space-y-6">
        <h1 class="text-3xl md:text-5xl font-extrabold tracking-tight text-zinc-900">
            Everything you need,
            <span class="block text-zinc-500">delivered to your door.</span>
        </h1>
        <p class="text-base md:text-lg text-zinc-600 max-w-2xl mx-auto">
            Discover a premium shopping experience with Aaramba.
        </p>
        <a href="{% url 'products:product_list' %}"
           class="inline-flex h-12 items-center justify-center rounded-md
                  bg-zinc-900 px-8 text-sm font-semibold text-white
                  hover:bg-zinc-800 transition">
            Start Shopping
        </a>
    </div>
</section>
{% endif %}

<!-- FEATURED CATEGORIES -->
<section class="py-14 container mx-auto px-4">
    <div class="flex items-center justify-between mb-8">
        <h2 class="text-xl md:text-2xl font-bold tracking-tight text-zinc-900">
            Shop by Category
        </h2>
        <a href="{% url 'products:product_list' %}"
           class="text-sm font-medium text-zinc-600 hover:text-zinc-900">
            View all â†’
        </a>
    </div>

    <div class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        {% for category in categories %}
        <a href="{% url 'products:product_list_by_category' category.slug %}"
           class="group block">
            <div
                class="aspect-[4/3] rounded-xl border border-zinc-200 bg-white
                       shadow-sm hover:shadow-md transition overflow-hidden">
                {% if category.image %}
                <img src="{{ category.image.url }}"
                     alt="{{ category.name }}"
                     class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300">
                {% else %}
                <div class="w-full h-full flex items-center justify-center bg-zinc-50">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"
                        class="text-zinc-400 group-hover:text-zinc-900 transition-colors">
                        <rect width="18" height="18" x="3" y="3" rx="2" ry="2" />
                        <line x1="3" y1="9" x2="21" y2="9" />
                        <line x1="9" y1="21" x2="9" y2="9" />
                    </svg>                </div>
                {% endif %}
            </div>
            <h3 class="mt-3 text-base font-semibold text-zinc-900">
                {{ category.name }}
            </h3>
            <p class="text-sm text-zinc-500">Explore {{ category.name }}</p>
        </a>
        {% endfor %}
    </div>
</section>

{% endblock %}
