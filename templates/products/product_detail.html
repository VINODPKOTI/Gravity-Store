{% extends 'base.html' %}

{% block title %}{{ product.title }} - Aaramba{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-12">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-12">
        <!-- Image Gallery -->
        <div class="space-y-4">
            <div class="aspect-square bg-zinc-100 rounded-2xl overflow-hidden border border-zinc-200">
                {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.title }}"
                    class="w-full h-full object-cover object-center">
                {% else %}
                <img src="https://placehold.co/800x800?text={{ product.title|urlencode }}" alt="{{ product.title }}"
                    class="w-full h-full object-cover object-center">
                {% endif %}
            </div>
        </div>

        <!-- Product Info -->
        <div class="space-y-8">
            <div>
                <h1 class="text-3xl font-bold tracking-tight text-zinc-900 sm:text-4xl">{{ product.title }}</h1>
                <div class="mt-4 flex items-center gap-4">
                    {% if product.get_active_offer %}
                    <p class="text-3xl font-bold text-zinc-900">₹{{ product.discounted_price }}</p>
                    <p class="text-xl text-zinc-500 line-through">₹{{ product.base_price }}</p>
                    <span
                        class="inline-flex items-center rounded-full bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/10">
                        {{ product.get_active_offer.discount_percent }}% OFF
                    </span>
                    {% else %}
                    <p class="text-3xl font-bold text-zinc-900">₹{{ product.base_price }}</p>
                    {% endif %}
                </div>
            </div>

            <div class="prose prose-zinc text-zinc-600">
                <p>{{ product.description }}</p>
            </div>

            <form action="{% url 'orders:add_to_cart' product.id %}" method="post"
                class="space-y-6 pt-6 border-t border-zinc-200">
                {% csrf_token %}

                <div>
                    <label for="sku" class="block text-sm font-medium text-zinc-900 mb-2">Select Option</label>
                    <select name="sku" id="sku"
                        class="block w-full rounded-md border-zinc-300 py-3 pl-3 pr-10 text-base focus:border-zinc-900 focus:outline-none focus:ring-zinc-900 sm:text-sm border">
                        {% for sku in skus %}
                        <option value="{{ sku.id }}">
                            {{ sku.sku_code }} - ₹{{ sku.price }} ({% for key, val in sku.attributes.items %}{{ key }}:
                            {{ val }}{% if not forloop.last %}, {% endif %}{% endfor %}){% if sku.stock <= 0 %} (Out of
                                Stock){% endif %} </option>
                                {% empty %}
                        <option disabled>No options available</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="flex gap-4">
                    <button type="submit"
                        class="flex-1 flex items-center justify-center rounded-md border border-transparent bg-zinc-900 px-8 py-3 text-base font-medium text-white hover:bg-zinc-800 focus:outline-none focus:ring-2 focus:ring-zinc-900 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"
                        {% if not skus %}disabled{% endif %}>
                        Add to Cart
                    </button>
                    <button type="button"
                        class="flex items-center justify-center rounded-md border border-zinc-200 bg-white px-4 py-3 text-zinc-900 hover:bg-zinc-50 focus:outline-none focus:ring-2 focus:ring-zinc-900 focus:ring-offset-2">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path
                                d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z" />
                        </svg>
                    </button>
                </div>
            </form>

            <div class="pt-6 border-t border-zinc-200">
                <div class="flex items-center gap-2 text-sm text-zinc-500">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z" />
                        <circle cx="12" cy="10" r="3" />
                    </svg>
                    <span>Sold by <span class="font-medium text-zinc-900">{{ product.seller.business_name }}</span></span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}