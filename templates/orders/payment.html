{% extends 'base.html' %}
{% load static %}

{% block title %}Complete Payment - Aaramba{% endblock %}

{% block content %}
<div class="bg-zinc-50 min-h-screen flex items-center justify-center p-4">
    <div class="max-w-xl w-full bg-white rounded-[3rem] border border-zinc-200 shadow-2xl overflow-hidden p-8 md:p-12">
        <div class="text-center mb-8">
            <div
                class="w-20 h-20 bg-zinc-900 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-xl rotate-3">
                <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z">
                    </path>
                </svg>
            </div>
            <h1 class="text-3xl font-black text-zinc-900 mb-2">COMPLETE PAYMENT</h1>
            <p class="text-zinc-500 font-medium">Please do not refresh or close this page</p>
        </div>

        <div class="bg-zinc-50 rounded-2xl border border-zinc-100 p-6 mb-8">
            <div class="flex justify-between items-center mb-4">
                <span class="text-xs font-bold text-zinc-400 uppercase tracking-widest">Order ID</span>
                <span class="text-sm font-bold text-zinc-900">#{{ order.id }}</span>
            </div>
            <div class="flex justify-between items-end">
                <span class="text-xs font-bold text-zinc-400 uppercase tracking-widest">Total Amount</span>
                <span class="text-4xl font-black text-zinc-900 line-height-1">â‚¹{{ order.total_amount|floatformat:0
                    }}</span>
            </div>
        </div>

        {% if error %}
        <div class="bg-red-50 border border-red-100 text-red-600 p-4 rounded-xl text-sm font-medium mb-8">
            {{ error }}
        </div>
        {% endif %}

        <div class="space-y-4">
            <button id="rzp-button1"
                class="w-full py-5 rounded-2xl bg-zinc-900 text-white font-black hover:bg-zinc-800 transition-all shadow-lg hover:shadow-xl active:scale-95 flex items-center justify-center gap-3">
                PAY NOW WITH RAZORPAY
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd"
                        d="M12.293 5.293a1 1 0 011.414 0l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-2.293-2.293a1 1 0 010-1.414z"
                        clip-rule="evenodd"></path>
                </svg>
            </button>
            <p class="text-center text-[10px] text-zinc-400 font-bold uppercase tracking-widest">Secure 256-bit SSL
                encrypted connection</p>
        </div>
    </div>
</div>

<!-- Razorpay Script -->
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
    var options = {
        "key": "{{ razorpay_key_id }}",
        "amount": "{{ amount }}",
        "currency": "{{ currency }}",
        "name": "Aaramba Store",
        "description": "Payment for Order #{{ order.id }}",
        "image": "https://aaramba.com/logo.png",
        "order_id": "{{ razorpay_order_id }}",
        "callback_url": "{{ callback_url }}",
        "prefill": {
            "name": "{{ request.user.get_full_name|default:request.user.username }}",
            "email": "{{ request.user.email }}",
            "contact": "{{ request.user.phone|default:'' }}"
        },
        "theme": {
            "color": "#18181b"
        }
    };
    var rzp1 = new Razorpay(options);
    document.getElementById('rzp-button1').onclick = function (e) {
        rzp1.open();
        e.preventDefault();
    }
</script>
{% endblock %}